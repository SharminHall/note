## 浏览器缓存
### 强缓存

http1.0 `Expires` 过期时间点。本地时间可能会更改导致与服务器不一致

http1.1 `Cache-Control`：
  1. max-age: 过期时长
  2. public: 服务器和客户端都可缓存
  3. private: 仅客户端可缓存
  4. s-maxage: 服务器缓存时长
  5. no-cache: 跳过强缓存，到协商缓存
  6. no-store: 不缓存
  7. max-stale: 最大过期时间，可以接收超出超时期间的响应消息
  8. min-fresh: 最小新鲜度，可以接收响应时间小于当前时间加上指定时间的响应

### 协商缓存
  1. Last-Modified / If-Modified-Since 服务器最后修改时间。缺点1.无法感知一秒以内多次修改更新；2.编辑但未修改，依然会造成缓存失效
  2. E-Tag / If-None-Match 服务器内容修改标志

两者对比：性能上Last-Modified占优；精确度上E-Tag占优；E-Tag优先级高

### 缓存位置

1. Service Worker：运行在浏览器背后的独立线程。PWA的核心技术。
2. Memory Cache：内存。
3. Disk Cache：硬盘缓存。
4. Push Cache：推送缓存（HTTP/2），只在会话（Session）中存在，一旦会话结束就被释放，并且缓存时间也很短暂。

## 浏览器的本地存储

### cookie

无状态的http需要一个状态标记的产物，以便让服务器知道访问者是谁。

缺点：

  1. 容量：4KB的容量极小
  2. 性能：域名绑定，任一该域名下的请求都会携带所有该域名下的cookie
  3. 安全：CSRF(Cross-site request forgery), 即跨站请求伪造。

### localStorage

较大容量的持久存储方式

### sessionStorage

较大容量的会话级别的存储（窗口关闭则消失）

### indexedDB

运行在浏览器中的非关系型数据库。

## 浏览器渲染流程（从输入url到页面呈现）

### 浏览器进程 -- 预知识
1. 浏览器主进程 -- 界面显示、用户交互、子进程管理，同时提供存储等功能
2. 网络进程 -- 专门处理网络请求
3. 渲染进程 -- 渲染页面（V8引擎和Blink排版引擎）
4. 插件进程 -- 浏览器插件
5. GPU进程 -- 界面绘制，3D加速

### 资源文件拉取 -- 网络

1. 浏览器构建url对应请求
2. 网络进程查看资源是否被强缓存，是的话，直接返回资源给浏览器进程，结束这一段
3. DNS域名解析，去找对应ip，域名解析也会被缓存，如果有，可直接使用不需要再去解析
4. 等待TCP队列(一个域名最多存在6个) -> 建立TCP连接（三次握手）
5. HTTP请求
6. 服务器返回对应资源，网络进程解析响应头：（结束后可断开TCP，除非头部信息中含有`Connection:Keep-Alive`，则保持长连接。）

网络进程识别状态码301或者302：重定向操作。则会重新打开新的header中`location`字段对应网址，重复上述操作。

### 解析html文件

1. 构建DOM树
2. 计算样式
3. 生成布局树

### 渲染

1. 建立图层
2. 生成绘制队列
3. 生成图块和生成位图
4. 画图

## 浏览器的回流与重绘


